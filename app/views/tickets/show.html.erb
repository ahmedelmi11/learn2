<div class="container min-height">
  <h1><%= @ticket.title %></h1>

  <!-- # this used to have an option to add a ticket technology but Ahmed has added this to the new page  -->


  <p><%= @ticket.description %></p>

  <!-- # this displays an edit option if the user viewing the ticket is the user who created the  -->

  <% @ticket.technologies.each do |tech| %>
    <p><%= tech.name %></p>
  <% end %>

  <% if @ticket.student == current_user %>
    <%= link_to "Edit", edit_ticket_path, class: "btn btn-lg btn-default" %>
    <%= link_to "Dashboard", user_path, class: "btn btn-lg btn-primary" %>
  <% end %>

  <% if current_user.teacher? &&  @ticket.student != current_user && @ticket.available? %>
    <%= link_to "Take this ticket", ticket_accept_ticket_path(@ticket), class: "btn btn-primary", method: :patch  %>
  <% end %>

 <% if current_user.teacher? &&  @ticket.student != current_user && @ticket.active? %>
    <%= link_to "Mark ticket finished", ticket_mark_ticket_finished_path(@ticket), class: "btn btn-primary", method: :patch  %>
  <% end %>

  <% if @ticket.taken? &&  (@ticket.student == current_user || @ticket.teacher == current_user)  %>

    <h1>Add comment </h1>
    <%= simple_form_for [@ticket, @comment] do |c| %>
      <%= c.input :content %>
      <%= c.button :submit %>
    <% end %>

    <% @comments.each do |c| %>
      <p><%= c.user.email %></p>
      <%= markdown(c.content) %>
    <% end %>
  <% end %>
</div>


